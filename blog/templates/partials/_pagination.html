{% if is_paginated %}
<nav class="d-flex justify-content-center mt-4" aria-label="Paginación">
  <ul class="pagination pagination-sm flex-wrap game-pagination shadow-sm rounded-3 overflow-hidden">

    <!-- Botones anteriores/siguientes -->
    <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
      <a class="page-link" href="#" data-page-link data-page="1">««</a>
    </li>
    <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
      <a class="page-link" href="#" data-page-link data-page="{{ page_obj.previous_page_number|default:1 }}">«</a>
    </li>

    <!-- Ventana de páginas -->
    {% with total=page_obj.paginator.num_pages current=page_obj.number %}
      {% if current|add:'-2' > 1 %}
        <li class="page-item"><a class="page-link" href="#" data-page-link data-page="1">1</a></li>
        <li class="page-item disabled"><span class="page-link">…</span></li>
      {% endif %}

      {% for i in page_obj.paginator.page_range %}
        {% if i >= current|add:'-2' and i <= current|add:'2' %}
          <li class="page-item {% if i == current %}active{% endif %}">
            <a class="page-link" href="#" data-page-link data-page="{{ i }}">{{ i }}</a>
          </li>
        {% endif %}
      {% endfor %}

      {% if current|add:'2' < total %}
        <li class="page-item disabled"><span class="page-link">…</span></li>
        <li class="page-item"><a class="page-link" href="#" data-page-link data-page="{{ total }}">{{ total }}</a></li>
      {% endif %}
    {% endwith %}

    <!-- Botones siguientes -->
    <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
      <a class="page-link" href="#" data-page-link data-page="{{ page_obj.next_page_number|default:page_obj.paginator.num_pages }}">»</a>
    </li>
    <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
      <a class="page-link" href="#" data-page-link data-page="{{ page_obj.paginator.num_pages }}">»»</a>
    </li>
  </ul>
</nav>

<div class="text-center small text-secondary mt-1">
  Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}
</div>

<style>
  .game-pagination .page-link {
    min-width: 2.5rem;
    text-align: center;
    background: #1c1c1c;
    color: #eee;
    border: none;
    font-weight: 600;
    transition: all .2s ease;
  }
  .game-pagination .page-link:hover {
    background: #2d89ef;
    color: #fff;
  }
  .game-pagination .page-item.active .page-link {
    background: #ff3c00;
    color: #fff;
    font-weight: 700;
  }
  .game-pagination .page-item.disabled .page-link {
    opacity: 0.4;
    background: #2a2a2a;
    cursor: not-allowed;
  }
</style>

<script>
  (function () {
    document.querySelectorAll('[data-page-link]').forEach(function (a) {
      var page = a.getAttribute('data-page');
      if (!page) return;
      var url = new URL(window.location.href);
      url.searchParams.set('page', page);
      a.href = url.pathname + (url.searchParams.toString() ? '?' + url.searchParams.toString() : '');
    });
  })();
</script>
{% endif %}